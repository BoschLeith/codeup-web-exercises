<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>First Mapbox Map</title>
	<!-- Mapbox CSS -->

	<script src='https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.js'></script>
	<link href='https://api.mapbox.com/mapbox-gl-js/v2.5.0/mapbox-gl.css' rel='stylesheet' />

	<!-- Custom CSS -->
	<style>
		#map {
			/* the width and height may be set to any size */
			width: 100%;
			height: 500px;
		}
	</style>
</head>
<body>

<h1>My First Mapbox Map!</h1>

<!-- The HTML element that serves as the Mapbox container -->
<div id='map'></div>

<!-- Mapbox JS -->
<script src="keys.js"></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<!-- Custom JS -->
<script>
	mapboxgl.accessToken = mapBoxKey;
	var map = new mapboxgl.Map({
		container: 'map',
		style: 'mapbox://styles/mapbox/streets-v11',
		zoom: 13,
		center: [-98.4683, 29.5312]
	});

	var favoriteRestaurants = [
		{
			name: "Whataburger",
			address: "10011 San Pedro Ave, San Antonio, TX 78216",
			website: "https://whataburger.com/home"
		},
		{
			name: "Taco Palenque",
			address: "1002 NE Interstate 410 Loop, San Antonio, TX 78209",
			website: "https://www.tacopalenque.com/"
		},
		{
			name: "Wild Barley Kitchen Co.",
			address: "8403 Broadway, San Antonio, TX 78209",
			website: "https://www.toasttab.com/wildbarleykitchenco/v3"
		}
	]

	function mapMarker(array, token){
		array.forEach(function (restaurant){
			geocode(restaurant.address, token).then(function(results){

				var popUp = new mapboxgl.Popup()
					.setHTML("<div>" +
						"<div>" + restaurant.name + "</div>" +
						"<div>" + restaurant.address + "</div>" +
						"<div><a href=" + restaurant.website + ">" + "Website" + "</a></div>" +
						"</div>")

				new mapboxgl.Marker()
					.setLngLat(results)
					.setPopup(popUp)
					.addTo(map)

			})
		})
	}

	mapMarker(favoriteRestaurants, mapBoxKey);

</script>
</body>
</html>